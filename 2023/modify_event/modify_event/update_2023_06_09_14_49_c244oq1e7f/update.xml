<?xml version="1.0" encoding="utf-8"?>
<data>
	<basic>
		<id>c244oq1e7f</id>
		<create_date>2023-06-09T14:49:10+00:00</create_date>
		<server_version>2023.2.668 (2023-06-08)</server_version>
	</basic>
	<notification_templates>
		<notification_template>
			<id>0x646624AD4C8058E1</id>
			<code>modify_event</code>
			<name>Уведомление о создании/изменении мероприятия</name>
			<subject>Уведомление о создании/изменении мероприятия</subject>
			<body>&lt;%&#10;&#10;DefCharset="utf-8"; //кодировка по-умолчанию&#10;//----------------------------------&#10;// часовой пояс времени, указываемого в параметрах карточки мероприятия, &#10;// если параметр отрицательный укажите (0-X), где X - число часов [десятичная дробь]&#10;BASE_TIME_ZONE = 3; &#10;//----------------------------------&#10;&#10;teOrganizerObject = OpenDoc( UrlFromDocID( OptInt( objDocID ) ) ).TopElem;&#10;teEvent = objDoc; // переопределим для удобства чтения&#10;file_id=String(teEvent.id).slice(String(teEvent.id).length-6);&#10;&#10;sOrganizerFullname = teOrganizerObject.fullname;&#10;sOrganizerEmail = teOrganizerObject.email;&#10;sSubject = Text;&#10;sComment = teEvent.comment;&#10;sParticipantEmail = "";&#10;sParticipantData = "";&#10;&#10;sSender = sOrganizerFullname + " &lt;" + sOrganizerEmail + "&gt;"&#10;text="";&#10;&#10;html_text = "&lt;div style=\"font-family:Arial;line-height:1;font-size:22px;background-color:#aad4ff;border-radius:12px;padding:16px;\"&gt;";&#10;html_text += "&lt;p style=\"padding:0;font-family:Arial;line-height:1;margin: 0 0 17px;font-size:22px;color:#000000\"&gt;Комментарий к звонку:&lt;/p&gt; ";&#10;html_text += "&lt;p style=\"padding:0;margin: 0 0 10px;line-height:20px;font-size:18px;\"&gt;" + sComment +"&lt;/p&gt;";&#10;html_text += "&lt;/div&gt;";&#10;&#10;for(participant in teEvent.participants)&#10;{&#10;&#9;teParticipantObject = OpenDoc( UrlFromDocID( OptInt( participant.person_id ) ) ).TopElem;&#10;&#9;&#10;&#9;sParticipantEmail += teParticipantObject.fullname +' &lt;'+teParticipantObject.email+'&gt;,';&#10;&#9;sParticipantData += 'ATTENDEE;ROLE=REQ-PARTICIPANT;PARTSTAT=ACCEPTED;CN=' + teParticipantObject.lastname + ' ' + teParticipantObject.firstname + ';RSVP=FALSE:mailto:' + teParticipantObject.email + '\n';&#10;}&#10;&#10;RSVP_STR='FALSE';&#10;DT_START = DateOffset(teEvent.plan_start_date,(0-BASE_TIME_ZONE)*3600);&#10;DT_END = DateOffset(teEvent.plan_end_date,(0-BASE_TIME_ZONE)*3600);&#10;&#10;message_body = '&#10;To: '+sParticipantEmail+' &#10;Subject: '+sSubject+'&#10;MIME-Version: 1.0&#10;Content-Type: multipart/mixed; boundary="=_mixed 004128EAC32576F1_="&#10;X-Spam: Not detected&#10;X-Mras: Ok&#10;X-Mailru-Src: mxpdd&#10;X-Mras: Ok&#10;X-Mailru-Intl-Transport: d,ed4f05e&#10;&#10;This is a multipart message in MIME format.&#10;--=_mixed 004128EAC32576F1_=&#10;Content-Type: multipart/related; boundary="=_related 004128EAC32576F1_="&#10;&#10;&#10;--=_related 004128EAC32576F1_=&#10;Content-Type: multipart/alternative; boundary="=_alternative 004128EAC32576F1_="&#10;&#10;&#10;--=_alternative 004128EAC32576F1_=&#10;Content-Type: text/plain; charset=utf-8&#10;&#10;'+text+'&#10;&#10;--=_alternative 004128EAC32576F1_=&#10;Content-Type: text/html; charset=utf-8&#10;Content-Disposition: inline&#10;&#10;'+html_text+'&#10;&#10;--=_alternative 004128EAC32576F1_=&#10;Content-Type: text/calendar; method=REQUEST; charset=utf-8;&#10;&#10;BEGIN:VCALENDAR&#10;VERSION:2.0&#10;PRODID:-//WebSoft LTD//WebSoft 2//EN&#10;METHOD:REQUEST&#10;BEGIN:VEVENT&#10;DTSTART:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_START),StrXmlDate(DT_START).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTEND:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_END),StrXmlDate(DT_END).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTSTAMP:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(Date()),StrXmlDate(Date()).lastIndexOf('+')),'-',''),':','')+'Z&#10;TRANSP:OPAQUE&#10;SEQUENCE:0&#10;CLASS:PUBLIC&#10;SUMMARY:'+teEvent.name+'&#10;DESCRIPTION:'+sComment+'&#10;ORGANIZER;CN='+teOrganizerObject.fullname+':mailto:'+teOrganizerObject.email+'\n&#10;UID:646DBD0737BC5B53-WebSoft_Generated&#10;LOCATION:&#10;&#10;BEGIN:VALARM&#10;TRIGGER:-P1D&#10;DURATION:PT15M&#10;ACTION:DISPLAY&#10;DESCRIPTION:'+sComment+'&#10;X-WR-ALARMUID:646DBD0737BC5B52&#10;END:VALARM&#10;END:VEVENT&#10;END:VCALENDAR&#10;&#10;--=_alternative 004128EAC32576F1_=--&#10;--=_related 004128EAC32576F1_=&#10;&#10;--=_related 004128EAC32576F1_=--&#10;--=_mixed 004128EAC32576F1_=&#10;Content-Type: text/calendar; method=REQUEST; charset=utf-8; name="c766867.ics"&#10;Content-Disposition: attachment; filename="c766867.ics"&#10;&#10;BEGIN:VCALENDAR&#10;VERSION:2.0&#10;PRODID:-//WebSoft LTD//WebSoft 2//EN&#10;METHOD:REQUEST&#10;BEGIN:VEVENT&#10;DTSTART:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_START),StrXmlDate(DT_START).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTEND:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_END),StrXmlDate(DT_END).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTSTAMP:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(Date()),StrXmlDate(Date()).lastIndexOf('+')),'-',''),':','')+'Z&#10;TRANSP:OPAQUE&#10;SEQUENCE:0&#10;CLASS:PUBLIC&#10;SUMMARY:'+teEvent.name+'&#10;DESCRIPTION:'+sComment+'&#10;ORGANIZER;CN='+teOrganizerObject.fullname+':mailto:'+teOrganizerObject.email+'\n&#10;UID:646DBD0737BC5B53-WebSoft_Generated&#10;LOCATION:&#10;&#10;BEGIN:VALARM&#10;TRIGGER:-P1D&#10;DURATION:PT15M&#10;ACTION:DISPLAY&#10;DESCRIPTION:'+sComment+'&#10;X-WR-ALARMUID:646DBD0737BC5B52&#10;END:VALARM&#10;END:VEVENT&#10;END:VCALENDAR&#10;--=_mixed 004128EAC32576F1_=--&#10;'&#10;%&gt;&lt;%=message_body%&gt;</body>
			<body_type>plane</body_type>
			<is_std>true</is_std>
			<changed>true</changed>
			<doc_info>
				<creation>
					<user_login>user1</user_login>
					<user_id>6148914691236517121</user_id>
					<date>2023-06-08T17:02:05Z</date>
				</creation>
				<modification>
					<user_login>user1</user_login>
					<user_id>6148914691236517121</user_id>
					<date>2023-06-09T14:48:25Z</date>
				</modification>
			</doc_info>
		</notification_template>
	</notification_templates>
	<notifications>
		<notification>
			<id>0x646624D91C6E0804</id>
			<code>modify_event</code>
			<name>Уведомление о создании/изменении мероприятия</name>
			<recipients>
				<recipient>
					<recipient_type>eval_person_ids</recipient_type>
					<eval_ids_str>objDoc.participants</eval_ids_str>
					<notification_template_id>7234510178148702433</notification_template_id>
				</recipient>
				<recipient>
					<recipient_type>add</recipient_type>
					<eval_str>objDoc.participants</eval_str>
					<notification_template_id>7234510178148702433</notification_template_id>
				</recipient>
			</recipients>
			<field_recipient_type>auto</field_recipient_type>
			<notification_systems>
				<notification_system>
					<notification_system_id>6035867320053143919</notification_system_id>
				</notification_system>
			</notification_systems>
			<active>true</active>
			<is_std>true</is_std>
			<changed>true</changed>
			<date_shift_selector>0</date_shift_selector>
			<date_shift>0.0E0</date_shift>
			<sender_selector>0</sender_selector>
			<doc_info>
				<creation>
					<user_login>user1</user_login>
					<user_id>6148914691236517121</user_id>
					<date>2023-06-08T17:52:58Z</date>
				</creation>
				<modification>
					<user_login>user1</user_login>
					<user_id>6148914691236517121</user_id>
					<date>2023-06-08T17:52:58Z</date>
				</modification>
			</doc_info>
		</notification>
	</notifications>
</data>
