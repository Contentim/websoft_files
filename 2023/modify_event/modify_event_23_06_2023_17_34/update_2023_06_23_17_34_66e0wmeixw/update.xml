<?xml version="1.0" encoding="utf-8"?>
<data>
	<basic>
		<id>66e0wmeixw</id>
		<create_date>2023-06-23T17:34:52+00:00</create_date>
		<server_version>2023.2.663 (2023-06-01)</server_version>
	</basic>
	<notification_templates>
		<notification_template>
			<id>0x646624AD4C8058E1</id>
			<code>modify_event</code>
			<name>Уведомление о создании/изменении мероприятия</name>
			<subject>Уведомление о создании/изменении мероприятия</subject>
			<body>&lt;%&#10;&#10;//----------------------------------&#10;// часовой пояс времени, указываемого в параметрах карточки мероприятия, &#10;// если параметр отрицательный укажите (0-X), где X - число часов [десятичная дробь]&#10;BASE_TIME_ZONE = 3; &#10;//----------------------------------&#10;&#10;teOrganizerObject = OpenDoc( UrlFromDocID( OptInt( objDocID ) ) ).TopElem;&#10;teEvent = objDoc; // переопределим для удобства чтения&#10;file_id=String(teEvent.id).slice(String(teEvent.id).length-6);&#10;&#10;sOrganizerFullname = teOrganizerObject.fullname;&#10;sOrganizerEmail = teOrganizerObject.email;&#10;sSubject = Text;&#10;sComment = teEvent.comment;&#10;sParticipantEmail = "";&#10;sParticipantData = "";&#10;&#10;sSender = sOrganizerFullname + " &lt;" + sOrganizerEmail + "&gt;"&#10;&#10;html_text = "";&#10;text="";&#10;&#10;if(sComment != "")&#10;{&#9;&#10;&#9;html_text += "&lt;p style=\"font-size:18.0pt;font-family:&amp;quot;Segoe UI&amp;quot;,sans-serif;color:#252424\"&gt;Описание к событию&lt;/p&gt;";&#10;&#9;html_text += "&lt;p style=\"padding:0;margin: 0 0 10px;line-height:20px;font-size:18px;font-family:&amp;quot;Segoe UI&amp;quot;,sans-serif;\"&gt;" + sComment +"&lt;/p&gt;";&#10;}&#10;&#10;html_text += "&lt;p style=\"color:#5F5F5F\"&gt;________________________________________________________________________________&lt;/p&gt;";&#10;html_text += "&lt;p style=\"font-size:12pt;font-family:&amp;quot;Segoe UI&amp;quot;,sans-serif;color:#252424\"&gt;&lt;strong&gt;Звонок в WebSoft WorkSpace&lt;/strong&gt;&lt;/p&gt;&lt;/br&gt;";&#10;html_text += "&lt;a href=\""+ global_settings.settings.portal_base_url + "/vchat/conversation/"+ teEvent.conversation_id + "/call/" + teEvent.id +"\" target=\"_blank\" rel=\" noopener noreferrer\"  style=\"font-size:12pt;font-family:&amp;quot;Segoe UI&amp;quot;,sans-serif;color:#0066CC\"&gt;Щелкните здесь, чтобы присоединиться к звонку&lt;/a&gt;";&#10;html_text += "&lt;p&gt;&lt;span style=\"font-size:12pt;font-family:&amp;quot;Segoe UI&amp;quot;,sans-serif;color:#252424\" &gt;P.S. Пока работает только на компьютере&lt;/span&gt;&lt;/p&gt;";&#10;html_text += "&lt;p style=\"color:#5F5F5F\"&gt;________________________________________________________________________________&lt;/p&gt;"&#10;&#10;for(participant in teEvent.participants)&#10;{&#10;&#9;teParticipantObject = OpenDoc( UrlFromDocID( OptInt( participant.person_id ) ) ).TopElem;&#10;&#9;&#10;&#9;sParticipantEmail += teParticipantObject.fullname +' &lt;'+teParticipantObject.email+'&gt;,';&#10;&#9;sParticipantData += 'ATTENDEE;ROLE=REQ-PARTICIPANT;PARTSTAT=ACCEPTED;CN=' + teParticipantObject.lastname + ' ' + teParticipantObject.firstname + ';RSVP=FALSE:mailto:' + teParticipantObject.email + '\n';&#10;}&#10;&#10;RSVP_STR='FALSE';&#10;DT_START = DateOffset(teEvent.plan_start_date,(0-BASE_TIME_ZONE)*3600);&#10;DT_END = DateOffset(teEvent.plan_end_date,(0-BASE_TIME_ZONE)*3600);&#10;&#10;UID = StrHexInt(teEvent.id)+"-WebSoft_Generated"&#10;&#10;message_body = '&#10;To: '+sParticipantEmail+' &#10;Subject: '+sSubject+'&#10;MIME-Version: 1.0&#10;Content-Type: multipart/mixed; boundary="=_mixed 004128EAC32576F1_="&#10;X-Spam: Not detected&#10;X-Mras: Ok&#10;X-Mailru-Src: mxpdd&#10;X-Mras: Ok&#10;X-Mailru-Intl-Transport: d,ed4f05e&#10;&#10;This is a multipart message in MIME format.&#10;--=_mixed 004128EAC32576F1_=&#10;Content-Type: multipart/related; boundary="=_related 004128EAC32576F1_="&#10;&#10;&#10;--=_related 004128EAC32576F1_=&#10;Content-Type: multipart/alternative; boundary="=_alternative 004128EAC32576F1_="&#10;&#10;&#10;--=_alternative 004128EAC32576F1_=&#10;Content-Type: text/plain; charset=utf-8&#10;&#10;'+text+'&#10;&#10;--=_alternative 004128EAC32576F1_=&#10;Content-Type: text/html; charset=utf-8&#10;Content-Disposition: inline&#10;&#10;'+html_text+'&#10;&#10;--=_alternative 004128EAC32576F1_=&#10;Content-Type: text/calendar; method=REQUEST; charset=utf-8;&#10;&#10;BEGIN:VCALENDAR&#10;VERSION:2.0&#10;PRODID:-//WebSoft LTD//WebSoft 2//EN&#10;METHOD:REQUEST&#10;BEGIN:VEVENT&#10;DTSTART:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_START),StrXmlDate(DT_START).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTEND:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_END),StrXmlDate(DT_END).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTSTAMP:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(Date()),StrXmlDate(Date()).lastIndexOf('+')),'-',''),':','')+'Z&#10;TRANSP:OPAQUE&#10;SEQUENCE:0&#10;CLASS:PUBLIC&#10;SUMMARY:'+teEvent.name+'&#10;DESCRIPTION:'+sComment+'&#10;ORGANIZER;CN='+teOrganizerObject.fullname+':mailto:'+teOrganizerObject.email+'\n&#10;UID:'+UID+'&#10;LOCATION:&#10;&#10;BEGIN:VALARM&#10;TRIGGER:-P1D&#10;DURATION:PT15M&#10;ACTION:DISPLAY&#10;DESCRIPTION:'+sComment+'&#10;X-WR-ALARMUID:646DBD0737BC5B52&#10;END:VALARM&#10;END:VEVENT&#10;END:VCALENDAR&#10;&#10;--=_alternative 004128EAC32576F1_=--&#10;--=_related 004128EAC32576F1_=&#10;&#10;--=_related 004128EAC32576F1_=--&#10;--=_mixed 004128EAC32576F1_=&#10;Content-Type: text/calendar; method=REQUEST; charset=utf-8; name="c766867.ics"&#10;Content-Disposition: attachment; filename="c766867.ics"&#10;&#10;BEGIN:VCALENDAR&#10;VERSION:2.0&#10;PRODID:-//WebSoft LTD//WebSoft 2//EN&#10;METHOD:REQUEST&#10;BEGIN:VEVENT&#10;DTSTART:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_START),StrXmlDate(DT_START).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTEND:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(DT_END),StrXmlDate(DT_END).lastIndexOf('+')),'-',''),':','')+'Z&#10;DTSTAMP:'+StrReplace(StrReplace(StrLeftRange(StrXmlDate(Date()),StrXmlDate(Date()).lastIndexOf('+')),'-',''),':','')+'Z&#10;TRANSP:OPAQUE&#10;SEQUENCE:0&#10;CLASS:PUBLIC&#10;SUMMARY:'+teEvent.name+'&#10;DESCRIPTION:'+sComment+'&#10;ORGANIZER;CN='+teOrganizerObject.fullname+':mailto:'+teOrganizerObject.email+'\n&#10;UID:'+UID+'&#10;LOCATION:&#10;&#10;BEGIN:VALARM&#10;TRIGGER:-P1D&#10;DURATION:PT15M&#10;ACTION:DISPLAY&#10;DESCRIPTION:'+sComment+'&#10;X-WR-ALARMUID:646DBD0737BC5B52&#10;END:VALARM&#10;END:VEVENT&#10;END:VCALENDAR&#10;--=_mixed 004128EAC32576F1_=--&#10;'&#10;%&gt;&lt;%=message_body%&gt;</body>
			<body_type>html</body_type>
			<is_std>1</is_std>
			<changed>1</changed>
			<doc_info>
				<creation>
					<user_login>user1</user_login>
					<user_id>0x5555555555555501</user_id>
					<date>2023-06-23T17:34:04+00:00</date>
				</creation>
				<modification>
					<user_login>user1</user_login>
					<user_id>0x5555555555555501</user_id>
					<date>2023-06-23T17:34:04+00:00</date>
				</modification>
			</doc_info>
		</notification_template>
	</notification_templates>
</data>
